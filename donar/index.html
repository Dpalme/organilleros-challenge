<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0'>
    <meta http-equiv='X-UA-Compatible' content='ie=edge'>

    <!-- Primary Meta Tags -->
    <title>La Unión de Organilleros de México</title>
    <meta name='title' content='La Unión de Organilleros de México'>
    <meta name='description' content=''>
    <meta keywords='organilleros, mexico, donar, campaña, organillero'>
    <link rel='icon' type='image/png' href='https://dpalmer.in/img/Dicon.png'>

    <!-- Twitter -->
    <meta name='twitter:card' content='summary_large_image'>

    <!-- Open Graph / Facebook -->
    <meta property='og:type' content='website'>
    <meta property='og:title' content='La Unión de Organilleros de México'>
    <meta property='og:description' content=''>
    <meta property='og:image' content=''>

    <!-- CSS -->
    <link rel='stylesheet' type='text/css' href='../css/bootstrap.css'>
    <link rel='stylesheet' type='text/css' href='../css/custom-styles.css'>
</head>

<body>
    <nav>
        <div class="container d-flex align-items-center">
            <a href="../" class="branding flex-grow-1">Unión de Organilleros</a>
            <button class="nav-button" type="button" data-toggle="collapse" data-target="#navbarToggler"
                aria-controls="navbarToggler" aria-expanded="false" aria-label="Toggle navigation">
            </button>
            <div id=nav-exit></div>
            <div class="nav-menu flex-grow-1 text-right" id="navbarToggler">
                <a href="../donar/" class="nav-link current">Donar</a>
                <a href="../historia-del-oficio/" class="nav-link">Historia</a>
                <a href="../historia-de-la-union/" class="nav-link">La Unión</a>
                <a href="../covid-19/" class="nav-link">Covid-19</a>
                <a href="../galeria/" class="nav-link">Galeria</a>
            </div>
        </div>
    </nav>

    <main class="container mt-5">
        <div class="col-8">
            <h1>Donar</h1>
            <p>El servicio de Paypal cobra una comisión de tus donativos. La mejor manera de ayudarnos es con una
                transferencia directa, con una transeferncia de SPEI o CODI.</p>
            <div class="d-flex">
                <div class="w-50">
                    <h2>Información</h2>
                    <p>Clabe:<br>
                        <span class="main-red">6025414926199423</span><br>
                        Banco:<br>
                        <span class="main-red">Banco de México</span></p>
                </div>

                <div class="w-50">
                    <div id="smart-button-container">
                        <div>
                            <label class="text-uppercase d-block" for="description">Mensaje (Opcional)</label>
                            <input class="w-100" type="text" name="descriptionInput" id="description" maxlength="127" value="">
                        </div>
                        <p id="descriptionError" class="text-center" style="visibility: hidden; color:red">Please enter
                            a description</p>
                        <div>
                            <label for="amount" class="d-block text-uppercase">Donativo</label>
                            <div class="w-100 d-flex align-items-center">
                                <input class="flex-grow-1 pr-5" name="amountInput" type="number" id="amount" value="">
                                <span class="position-absolute mr-4" style="right:0">MXN</span>
                            </div>
                        </div>
                        <p id="priceLabelError" style="visibility: hidden; color:red; text-align: center;">Please enter a price</p>
                        <div id="invoiceidDiv" style="text-align: center; display: none;"><label for="invoiceid">
                            </label><input name="invoiceid" maxlength="127" type="text" id="invoiceid" value=""></div>
                        <p id="invoiceidError" style="visibility: hidden; color:red; text-align: center;">Please enter
                            an Invoice ID</p>
                        <div style="text-align: center; margin-top: 0.625rem;" id="paypal-button-container"></div>
                    </div>
                    <script src="https://www.paypal.com/sdk/js?client-id=sb&currency=MXN"
                        data-sdk-integration-source="button-factory"></script>
                    <script>
                        function initPayPalButton() {
                            var description = document.querySelector('#smart-button-container #description');
                            var amount = document.querySelector('#smart-button-container #amount');
                            var descriptionError = document.querySelector('#smart-button-container #descriptionError');
                            var priceError = document.querySelector('#smart-button-container #priceLabelError');
                            var invoiceid = document.querySelector('#smart-button-container #invoiceid');
                            var invoiceidError = document.querySelector('#smart-button-container #invoiceidError');
                            var invoiceidDiv = document.querySelector('#smart-button-container #invoiceidDiv');

                            var elArr = [description, amount];

                            if (invoiceidDiv.firstChild.innerHTML.length > 1) {
                                invoiceidDiv.style.display = "block";
                            }

                            var purchase_units = [];
                            purchase_units[0] = {};
                            purchase_units[0].amount = {};

                            function validate(event) {
                                return event.value.length > 0;
                            }

                            paypal.Buttons({
                                style: {
                                    color: 'white',
                                    shape: 'pill',
                                    label: 'paypal',
                                    layout: 'vertical',

                                },

                                onInit: function (data, actions) {
                                    actions.disable();

                                    if (invoiceidDiv.style.display === "block") {
                                        elArr.push(invoiceid);
                                    }

                                    elArr.forEach(function (item) {
                                        item.addEventListener('keyup', function (event) {
                                            var result = elArr.every(validate);
                                            if (result) {
                                                actions.enable();
                                            } else {
                                                actions.disable();
                                            }
                                        });
                                    });
                                },

                                onClick: function () {
                                    if (description.value.length < 1) {
                                        descriptionError.style.visibility = "visible";
                                    } else {
                                        descriptionError.style.visibility = "hidden";
                                    }

                                    if (amount.value.length < 1) {
                                        priceError.style.visibility = "visible";
                                    } else {
                                        priceError.style.visibility = "hidden";
                                    }

                                    if (invoiceid.value.length < 1 && invoiceidDiv.style.display ===
                                        "block") {
                                        invoiceidError.style.visibility = "visible";
                                    } else {
                                        invoiceidError.style.visibility = "hidden";
                                    }

                                    purchase_units[0].description = description.value;
                                    purchase_units[0].amount.value = amount.value;

                                    if (invoiceid.value !== '') {
                                        purchase_units[0].invoice_id = invoiceid.value;
                                    }
                                },

                                createOrder: function (data, actions) {
                                    return actions.order.create({
                                        purchase_units: purchase_units,
                                    });
                                },

                                onApprove: function (data, actions) {
                                    return actions.order.capture().then(function (details) {
                                        alert('Transaction completed by ' + details.payer.name
                                            .given_name + '!');
                                    });
                                },

                                onError: function (err) {
                                    console.log(err);
                                }
                            }).render('#paypal-button-container');
                        }
                        initPayPalButton();
                    </script>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <a href="../" class="branding flex-grow-1">Unión de Organilleros</a>
            <hr>
            <div class="w-50 ml-auto mr-0">
                <div class="nav-menu w-100 text-right">
                    <a href="../donar/" class="nav-link current">Donar</a>
                    <a href="../historia-del-oficio/" class="nav-link">Historia</a>
                    <a href="../historia-de-la-union/" class="nav-link">La Unión</a>
                    <a href="../covid-19/" class="nav-link">Covid-19</a>
                    <a href="../galeria/" class="nav-link pr-0">Galeria</a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        document.querySelector('[data-target="#navbarToggler"]').addEventListener('click', function () {
            document.getElementById('navbarToggler').classList.add('open');
            document.getElementById('nav-exit').classList.add('navbar-exit');
        });
        document.getElementById('nav-exit').addEventListener('click', function () {
            document.getElementById('navbarToggler').classList.remove('open');
            document.getElementById('nav-exit').classList.remove('navbar-exit');
        });
    </script>
</body>

</html>